{{ $videoPages := where site.RegularPages "Params.video" "=" true }}
{{ if gt (len $videoPages) 0 }}
<section class="video-section">
    <div class="section-header">
        <h2 class="section-title">
            <svg class="icon" viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" fill="none">
                <polygon points="23 7 16 12 23 17 23 7"></polygon>
                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
            </svg>
            最新视频
        </h2>
    </div>
    
    <div class="video-grid">
        {{ range first 7 (sort $videoPages "Date" "desc") }}
        {{ $youtubeID := .Params.youtube_id }}
        {{ if not $youtubeID }}
            {{ range findRE `{{< youtube ([^}]+) >}}` .Content }}
                {{ $youtubeID = replaceRE `{{< youtube ([^}]+) >}}` "$1" . }}
                {{ $youtubeID = trim $youtubeID " " }}
            {{ end }}
        {{ end }}
        
        <div class="video-card">
            <a href="{{ .Permalink }}" class="video-link">
                <div class="video-thumbnail">
                    {{ if .Params.image }}
                        <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}" loading="lazy">
                    {{ else if $youtubeID }}
                        <img src="https://img.youtube.com/vi/{{ $youtubeID }}/maxresdefault.jpg" alt="{{ .Title }}" loading="lazy">
                    {{ else }}
                        <div class="thumbnail-placeholder">
                            <svg viewBox="0 0 24 24" width="48" height="48">
                                <polygon points="23 7 16 12 23 17 23 7"></polygon>
                                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
                            </svg>
                        </div>
                    {{ end }}
                    <div class="play-overlay"></div>
                    {{ if $youtubeID }}<div class="youtube-badge">YouTube</div>{{ end }}
                    <div class="video-duration">{{ .Params.duration | default "视频" }}</div>
                </div>
                
                <div class="video-info">
                    <h3 class="video-title">{{ .Title }}</h3>
                    <div class="video-meta">
                        <span class="video-date">{{ .Date.Format "2006-01-02" }}</span>
                        {{ if .Params.tags }}
                        <div class="video-tags">
                            {{ range first 2 .Params.tags }}
                            <span class="tag"># {{ . }}</span>
                            {{ end }}
                        </div>
                        {{ end }}
                    </div>
                    {{ if .Description }}
                    <p class="video-description">{{ .Description }}</p>
                    {{ end }}
                </div>
            </a>
        </div>
        {{ end }}
        
        <!-- 查看更多卡片 -->
        <a href="https://www.youtube.com/@laosji" target="_blank" class="view-more-card">
            <div class="view-more-content">
                <div class="view-more-icon">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path d="m9 18 6-6-6-6"/>
                    </svg>
                </div>
                <h3 class="view-more-text">查看更多</h3>
                <p class="view-more-desc">订阅我的频道</p>
            </div>
        </a>
    </div>
</section>
{{ end }}